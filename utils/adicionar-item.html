<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Generate JSON Item</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f6f7fb; padding: 40px; color: #333; }
    form { background: white; border-radius: 10px; padding: 20px; max-width: 650px; margin: auto; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    label { display: block; margin-top: 12px; font-weight: bold; }
    input, textarea { width: 100%; padding: 8px; margin-top: 4px; border: 1px solid #ccc; border-radius: 6px; font-size: 15px; }
    textarea { resize: vertical; }
    .category-buttons { display: flex; gap: 10px; margin-top: 6px; }
    .category-btn { flex: 1; text-align: center; padding: 8px; border: 1px solid #ccc; border-radius: 6px; background: #f0f0f0; cursor: pointer; transition: 0.2s; user-select: none; }
    .category-btn:hover { background: #e4e4e4; }
    .category-btn.active { background: #3e78b2; color: white; border-color: #3e78b2; }
    button { margin-top: 20px; background: #3e78b2; color: white; border: none; padding: 10px 20px; font-size: 16px; border-radius: 8px; cursor: pointer; }
    button:hover { background: #004ba8; }
    pre { background: #1e1e1e; color: #dcdcdc; padding: 20px; border-radius: 10px; margin-top: 25px; white-space: pre-wrap; word-break: break-word; }
    .paypal-section { margin-top: 20px; padding: 15px; background: #f0f7ff; border-radius: 8px; border: 1px solid #b5d3f0; }
    .inline { display: flex; gap: 12px; align-items: center; }
    .inline > * { flex: 1; }
  </style>
</head>
<body>

  <form id="jsonForm">
    <h2>Generate JSON Item</h2>

    <label for="id">ID</label>
    <input type="text" id="id" name="id" placeholder="e.g., lensflare" required>

    <label for="name">Name</label>
    <input type="text" id="name" name="name" placeholder="e.g., Shader Lens Flare" required>

    <label>Category</label>
    <div class="category-buttons">
      <div class="category-btn" data-value="shaders">Shaders</div>
      <div class="category-btn" data-value="logic">Logic</div>
      <div class="category-btn" data-value="models">Models</div>
    </div>

    <div class="inline">
      <div>
        <label for="price">Price (US$)</label>
        <input type="text" id="price" name="price" placeholder="e.g., 39.90">
      </div>
      <div>
        <label for="free">Free?</label>
        <input type="checkbox" id="free" name="free">
      </div>
    </div>

    <label for="downloadUrl">Download URL (for free items)</label>
    <input type="text" id="downloadUrl" name="downloadUrl" placeholder="file.zip">

    <label for="shortDesc">Short description</label>
    <input type="text" id="shortDesc" name="shortDesc" placeholder="e.g., Realistic lens flare simulation.">

    <label for="description">Full description</label>
    <textarea id="description" name="description" rows="4" placeholder="e.g., Realistic lens flare simulation with multiple halos and dynamic bloom..."></textarea>

    <label for="image">Main image</label>
    <input type="text" id="image" name="image" placeholder="e.g., lensflare-1.png">

    <label for="gallery">Gallery (comma separated)</label>
    <input type="text" id="gallery" name="gallery" placeholder="e.g., lensflare-1.png, lensflare-2.gif, lensflare-3.png">

    <div class="paypal-section">
      <h3>PayPal button (full HTML)</h3>
      <textarea id="paypalForm" name="paypalForm" rows="7" placeholder="Paste the full PayPal button HTML here..."></textarea>
    </div>

    <button type="button" onclick="generateJSON()">Generate JSON</button>
  </form>

  <pre id="output"></pre>

  <script>
    let selectedCategory = '';

    document.querySelectorAll('.category-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        selectedCategory = btn.dataset.value;
      });
    });

    function cleanHTMLForJSON(html) {
      return html
        .replace(/\r?\n|\r/g, ' ')
        .replace(/\s{2,}/g, ' ')
        .replace(/"/g, "'")
        .trim();
    }

    function generateJSON() {
      const id = document.getElementById('id').value.trim();
      const name = document.getElementById('name').value.trim();
      const category = selectedCategory || '';
      const price = document.getElementById('price').value.trim();
      const free = document.getElementById('free').checked;
      const shortDesc = document.getElementById('shortDesc').value.trim();
      const description = document.getElementById('description').value.trim();
      const image = document.getElementById('image').value.trim();
      const downloadUrl = document.getElementById('download').value.trim();
      const gallery = document.getElementById('gallery').value.split(',').map(i => i.trim()).filter(i => i !== '');
      const paypalForm = document.getElementById('paypalForm').value.trim();

      if (!category) {
        alert('Select a category before generating the JSON!');
        return;
      }

      const item = {
        id,
        name,
        category,
        ...(price && { price }),
        ...(free ? { free: true } : {}),
        ...(paypalForm && { button: cleanHTMLForJSON(paypalForm) }),
        shortDesc,
        description,
        image,
        gallery,
        ...(downloadUrl && { downloadUrl })
      };

      document.getElementById('output').textContent = JSON.stringify(item, null, 2);
    }
  </script>

</body>
</html>
